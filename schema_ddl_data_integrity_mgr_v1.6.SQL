/*
Created: 28/9/2010
Modified: 21/10/2010
Model: DIMGR_MODEL
Database: Oracle 10g
*/

-- Create tables section -------------------------------------------------

-- Table DIMGR.COLUMNS

CREATE TABLE "DIMGR"."COLUMNS"(
  "OWNER" Varchar2(30 ) CONSTRAINT "SYS_C0040423" NOT NULL,
  "TABLE_NAME" Varchar2(30 ) CONSTRAINT "SYS_C0040424" NOT NULL,
  "COLUMN_NAME" Varchar2(30 ) CONSTRAINT "SYS_C0040426" NOT NULL,
  "COLUMN_ID" Number CONSTRAINT "SYS_C0040425" NOT NULL,
  "DATA_TYPE" Varchar2(106 ) CONSTRAINT "SYS_C0040427" NOT NULL,
  "DATA_LENGTH" Number,
  "DATA_PRECISION" Number,
  "DATA_SCALE" Number,
  "COLUMN_DESC" Varchar2(100 ),
  "COLUMN_COMMENT" Varchar2(500 ),
  "NULLABLE" Varchar2(1 ) CONSTRAINT "SYS_C0040428" NOT NULL
        CONSTRAINT "CHECK_NULLABLE_COL" CHECK (nullable in ('Y', 'N')),
  "CONSTRAINT_DESC" Varchar2(500 ),
  "CONSTRAINT_CHECK_CONDITION" Clob,
  "CONSTRAINT_VALIDATION_QRY" Clob,
  "CONSTRAINT_NAME" Varchar2(50 )
)
/

-- Create indexes for table DIMGR.COLUMNS

CREATE INDEX "DIMGR"."XIF1COLUMNS" ON "DIMGR"."COLUMNS" ("OWNER","TABLE_NAME")
/

CREATE UNIQUE INDEX "DIMGR"."XPKCOLUMNS" ON "DIMGR"."COLUMNS" ("OWNER","TABLE_NAME","COLUMN_NAME")
/

-- Add keys for table DIMGR.COLUMNS

ALTER TABLE "DIMGR"."COLUMNS" ADD CONSTRAINT "SYS_C0040429" PRIMARY KEY ("OWNER","TABLE_NAME","COLUMN_NAME")
   USING INDEX "DIMGR"."XPKCOLUMNS"
/

-- Table and Columns comments section
  
COMMENT ON TABLE "DIMGR"."COLUMNS" IS 'This table records the column-level constraints'
/
COMMENT ON COLUMN "DIMGR"."COLUMNS"."DATA_LENGTH" IS 'Length of the column (in bytes)'
/
COMMENT ON COLUMN "DIMGR"."COLUMNS"."CONSTRAINT_CHECK_CONDITION" IS 'Check constraint condition, without the CHECK keyword'
/

-- Table DIMGR.CONSTRAINT_TYPES

CREATE TABLE "DIMGR"."CONSTRAINT_TYPES"(
  "TYPE" Varchar2(20 ) CONSTRAINT "SYS_C0040430" NOT NULL,
  "TYPE_DESC" Varchar2(200 ),
  "COMMENT" Varchar2(500 )
)
/

-- Create indexes for table DIMGR.CONSTRAINT_TYPES

CREATE UNIQUE INDEX "DIMGR"."XPKCONSTRAINT_TYPES" ON "DIMGR"."CONSTRAINT_TYPES" ("TYPE")
/

-- Add keys for table DIMGR.CONSTRAINT_TYPES

ALTER TABLE "DIMGR"."CONSTRAINT_TYPES" ADD CONSTRAINT "SYS_C0040431" PRIMARY KEY ("TYPE")
   USING INDEX "DIMGR"."XPKCONSTRAINT_TYPES"
/

-- Table and Columns comments section
  
COMMENT ON TABLE "DIMGR"."CONSTRAINT_TYPES" IS 'Type of the constraint (table-level or inter-table-level): PK, FK, UNIQUE, TABLE-LEVEL, INTER-TABLE-LEVEL'
/

-- Table DIMGR.DIRESULTS

CREATE TABLE "DIMGR"."DIRESULTS"(
  "TEST_ID" Number(10,0),
  "OWNER" Varchar2(30 ),
  "TABLE_NAME" Varchar2(30 ),
  "COLUMN_NAME" Varchar2(30 ),
  "CONSTRAINT_NAME" Varchar2(500 ),
  "RESULT" Number(12,0),
  "POPULATION_DATE" Date
)
/

-- Table DIMGR.INTER_TABLE_CONSTRAINTS

CREATE TABLE "DIMGR"."INTER_TABLE_CONSTRAINTS"(
  "OWNER" Varchar2(30 ) NOT NULL,
  "TABLE_NAME" Varchar2(30 ) NOT NULL,
  "CONSTRAINT_NAME" Varchar2(50 ) CONSTRAINT "SYS_C0040436" NOT NULL,
  "CONSTRAINT_DESC" Varchar2(500 ),
  "CONSTRAINT_VALIDATION_QRY" Clob,
  "TYPE" Varchar2(20 )
)
/

-- Create indexes for table DIMGR.INTER_TABLE_CONSTRAINTS

CREATE INDEX "DIMGR"."XIF1INTER_TABLE_CONSTRAINTS" ON "DIMGR"."INTER_TABLE_CONSTRAINTS" ("TYPE")
/

CREATE UNIQUE INDEX "DIMGR"."XPKINTER_TABLE_CONSTRAINTS" ON "DIMGR"."INTER_TABLE_CONSTRAINTS" ("OWNER","TABLE_NAME","CONSTRAINT_NAME")
/

-- Add keys for table DIMGR.INTER_TABLE_CONSTRAINTS

ALTER TABLE "DIMGR"."INTER_TABLE_CONSTRAINTS" ADD CONSTRAINT "SYS_C0040437" PRIMARY KEY ("OWNER","TABLE_NAME","CONSTRAINT_NAME")
   USING INDEX "DIMGR"."XPKINTER_TABLE_CONSTRAINTS"
/

-- Table DIMGR.INTER_TABLE_CONS_REF_TABLES

CREATE TABLE "DIMGR"."INTER_TABLE_CONS_REF_TABLES"(
  "CONSTRAINT_NAME" Varchar2(50 ) CONSTRAINT "SYS_C0040432" NOT NULL,
  "OWNER" Varchar2(30 ) NOT NULL,
  "TABLE_NAME" Varchar2(30 ) NOT NULL,
  "REF_OWNER" Varchar2(30 ) NOT NULL,
  "REF_TABLE_NAME" Varchar2(30 ) NOT NULL
)
/

-- Create indexes for table DIMGR.INTER_TABLE_CONS_REF_TABLES

--CREATE INDEX "DIMGR"."XIF1INTER_TABLE_CONSTRAINTS_RE" ON "DIMGR"."INTER_TABLE_CONS_REF_TABLES" ("CONSTRAINT_NAME")
/

--CREATE INDEX "DIMGR"."XIF2INTER_TABLE_CONSTRAINTS_RE" ON "DIMGR"."INTER_TABLE_CONS_REF_TABLES" ()
/

CREATE UNIQUE INDEX "DIMGR"."XPKINTER_TABLE_CONSTRAINTS_REF" ON "DIMGR"."INTER_TABLE_CONS_REF_TABLES"("CONSTRAINT_NAME","OWNER","TABLE_NAME","REF_OWNER","REF_TABLE_NAME")
/

-- Add keys for table DIMGR.INTER_TABLE_CONS_REF_TABLES

ALTER TABLE "DIMGR"."INTER_TABLE_CONS_REF_TABLES" ADD CONSTRAINT "SYS_C0040435" PRIMARY KEY ("CONSTRAINT_NAME","OWNER","TABLE_NAME","REF_OWNER","REF_TABLE_NAME")
   USING INDEX "DIMGR"."XPKINTER_TABLE_CONSTRAINTS_REF"
/

-- Table DIMGR.OUTPUT

CREATE TABLE "DIMGR"."OUTPUT"(
  "TEXT" Varchar2(4000 )
)
/

-- Table DIMGR.SRCH_COND

CREATE TABLE "DIMGR"."SRCH_COND"(
  "OWNER" Varchar2(30 ),
  "TABLE_NAME" Varchar2(30 ),
  "COLUMN_NAME" Varchar2(30 ),
  "SEARCH_CONDITION" Clob,
  "CONSTRAINT_NAME" Varchar2(50 )
)
/

-- Table DIMGR.TABLES

CREATE TABLE "DIMGR"."TABLES"(
  "OWNER" Varchar2(30 ) CONSTRAINT "SYS_C0040442" NOT NULL,
  "TABLE_NAME" Varchar2(30 ) CONSTRAINT "SYS_C0040443" NOT NULL,
  "TABLE_DESC" Varchar2(150 ),
  "TABLE_COMMENT" Varchar2(500 ),
  "TABLE_TYPE" Varchar2(20 )
)
/

-- Create indexes for table DIMGR.TABLES

CREATE UNIQUE INDEX "DIMGR"."XPKTABLES" ON "DIMGR"."TABLES" ("OWNER","TABLE_NAME")
/

-- Add keys for table DIMGR.TABLES

ALTER TABLE "DIMGR"."TABLES" ADD CONSTRAINT "SYS_C0040444" PRIMARY KEY ("OWNER","TABLE_NAME")
   USING INDEX "DIMGR"."XPKTABLES"
/

-- Table and Columns comments section
  
COMMENT ON COLUMN "DIMGR"."TABLES"."TABLE_DESC" IS 'Records the description of the table.'
/
COMMENT ON COLUMN "DIMGR"."TABLES"."TABLE_TYPE" IS 'FACT  DIMENSION ACTIVITY SNAPSHOT'
/

-- Table DIMGR.TABLE_CONSTRAINTS

CREATE TABLE "DIMGR"."TABLE_CONSTRAINTS"(
  "OWNER" Varchar2(30 ) CONSTRAINT "SYS_C0040438" NOT NULL,
  "TABLE_NAME" Varchar2(30 ) CONSTRAINT "SYS_C0040439" NOT NULL,
  "CONSTRAINT_NAME" Varchar2(50 ) CONSTRAINT "SYS_C0040440" NOT NULL,
  "CONSTRAINT_DESC" Varchar2(500 ),
  "CONSTRAINT_VALIDATION_QRY" Clob,
  "TYPE" Varchar2(20 )
)
/

-- Create indexes for table DIMGR.TABLE_CONSTRAINTS

CREATE INDEX "DIMGR"."XIF1TABLE_CONSTRAINTS" ON "DIMGR"."TABLE_CONSTRAINTS" ("OWNER","TABLE_NAME")
/

CREATE INDEX "DIMGR"."XIF2TABLE_CONSTRAINTS" ON "DIMGR"."TABLE_CONSTRAINTS" ("TYPE")
/

CREATE UNIQUE INDEX "DIMGR"."XPKTABLE_CONSTRAINTS" ON "DIMGR"."TABLE_CONSTRAINTS" ("OWNER","TABLE_NAME","CONSTRAINT_NAME")
/

-- Add keys for table DIMGR.TABLE_CONSTRAINTS

ALTER TABLE "DIMGR"."TABLE_CONSTRAINTS" ADD CONSTRAINT "SYS_C0040441" PRIMARY KEY ("OWNER","TABLE_NAME","CONSTRAINT_NAME")
   USING INDEX "DIMGR"."XPKTABLE_CONSTRAINTS"
/

-- Table DIMGR.TUPLES

CREATE TABLE "DIMGR"."TUPLES"(
  "OWNER" Varchar2(30 ) CONSTRAINT "SYS_C0040454" NOT NULL,
  "TABLE_NAME" Varchar2(30 ) CONSTRAINT "SYS_C0040455" NOT NULL,
  "TUPLE_DESC" Varchar2(250 )
)
/

-- Create indexes for table DIMGR.TUPLES

CREATE UNIQUE INDEX "DIMGR"."XPKTUPLES" ON "DIMGR"."TUPLES" ("OWNER","TABLE_NAME")
/

-- Add keys for table DIMGR.TUPLES

ALTER TABLE "DIMGR"."TUPLES" ADD CONSTRAINT "SYS_C0040456" PRIMARY KEY ("OWNER","TABLE_NAME")
   USING INDEX "DIMGR"."XPKTUPLES"
/

-- Table and Columns comments section
  
COMMENT ON COLUMN "DIMGR"."TUPLES"."TUPLE_DESC" IS 'what each tuple represents in english'
/

-- Table DIMGR.TUPLE_CONSTRAINTS

CREATE TABLE "DIMGR"."TUPLE_CONSTRAINTS"(
  "OWNER" Varchar2(30 ) CONSTRAINT "SYS_C0040445" NOT NULL,
  "TABLE_NAME" Varchar2(30 ) CONSTRAINT "SYS_C0040446" NOT NULL,
  "CONSTRAINT_NAME" Varchar2(50 ) CONSTRAINT "SYS_C0040447" NOT NULL,
  "CONSTRAINT_DESC" Varchar2(500 ),
  "CONSTRAINT_CHECK_CONDITION" Clob,
  "CONSTRAINT_VALIDATION_QRY" Clob
)
/

-- Create indexes for table DIMGR.TUPLE_CONSTRAINTS

CREATE INDEX "DIMGR"."XIF1TUPLE_CONSTRAINTS" ON "DIMGR"."TUPLE_CONSTRAINTS" ("OWNER","TABLE_NAME")
/

CREATE UNIQUE INDEX "DIMGR"."XPKTUPLE_CONSTRAINTS" ON "DIMGR"."TUPLE_CONSTRAINTS" ("OWNER","TABLE_NAME","CONSTRAINT_NAME")
/

-- Add keys for table DIMGR.TUPLE_CONSTRAINTS

ALTER TABLE "DIMGR"."TUPLE_CONSTRAINTS" ADD CONSTRAINT "SYS_C0040448" PRIMARY KEY ("OWNER","TABLE_NAME","CONSTRAINT_NAME")
   USING INDEX "DIMGR"."XPKTUPLE_CONSTRAINTS"
/

-- Table DIMGR.TUPLE_CONSTRAINTS_REF_COLUMNS

CREATE TABLE "DIMGR"."TUPLE_CONSTRAINTS_REF_COLUMNS"(
  "OWNER" Varchar2(30 ) CONSTRAINT "SYS_C0040449" NOT NULL,
  "TABLE_NAME" Varchar2(30 ) CONSTRAINT "SYS_C0040450" NOT NULL,
  "CONSTRAINT_NAME" Varchar2(50 ) CONSTRAINT "SYS_C0040451" NOT NULL,
  "COLUMN_NAME" Varchar2(30 ) CONSTRAINT "SYS_C0040452" NOT NULL
)
/

-- Create indexes for table DIMGR.TUPLE_CONSTRAINTS_REF_COLUMNS

CREATE INDEX "DIMGR"."XIF1TUPLE_CONSTRAINTS_REF_COLU" ON "DIMGR"."TUPLE_CONSTRAINTS_REF_COLUMNS" ("OWNER","TABLE_NAME","CONSTRAINT_NAME")
/

CREATE INDEX "DIMGR"."XIF2TUPLE_CONSTRAINTS_REF_COLU" ON "DIMGR"."TUPLE_CONSTRAINTS_REF_COLUMNS" ("OWNER","TABLE_NAME","COLUMN_NAME")
/

CREATE UNIQUE INDEX "DIMGR"."XPKTUPLE_CONSTRAINTS_REF_COLUM" ON "DIMGR"."TUPLE_CONSTRAINTS_REF_COLUMNS" ("OWNER","TABLE_NAME","CONSTRAINT_NAME","COLUMN_NAME")
/

-- Add keys for table DIMGR.TUPLE_CONSTRAINTS_REF_COLUMNS

ALTER TABLE "DIMGR"."TUPLE_CONSTRAINTS_REF_COLUMNS" ADD CONSTRAINT "SYS_C0040453" PRIMARY KEY ("OWNER","TABLE_NAME","CONSTRAINT_NAME","COLUMN_NAME")
   USING INDEX "DIMGR"."XPKTUPLE_CONSTRAINTS_REF_COLUM"
/

-- Table TABLE_CONSTRAINTS_REF_COLUMNS

CREATE TABLE "TABLE_CONSTRAINTS_REF_COLUMNS"(
  "OWNER" Varchar2(30 ) NOT NULL,
  "TABLE_NAME" Varchar2(30 ) NOT NULL,
  "CONSTRAINT_NAME" Varchar2(50 ) NOT NULL,
  "COLUMN_NAME" Varchar2(30 ) NOT NULL,
  "POSITION" Number
)
/

-- Add keys for table TABLE_CONSTRAINTS_REF_COLUMNS

ALTER TABLE "TABLE_CONSTRAINTS_REF_COLUMNS" ADD CONSTRAINT "Key4" PRIMARY KEY ("OWNER","TABLE_NAME","CONSTRAINT_NAME","COLUMN_NAME")
/

-- Table and Columns comments section
  
COMMENT ON COLUMN "TABLE_CONSTRAINTS_REF_COLUMNS"."POSITION" IS 'Position of the column in the PK/UK constraint.'
/

-- Table ITABLE_CONSTRAINTS_REF_COLUMNS

CREATE TABLE "ITABLE_CONSTRAINTS_REF_COLUMNS"(
  "OWNER" Varchar2(30 ) NOT NULL,
  "TABLE_NAME" Varchar2(30 ) NOT NULL,
  "CONSTRAINT_NAME" Varchar2(50 ) NOT NULL,
  "COLUMN_NAME" Varchar2(30 ) NOT NULL
)
/

-- Add keys for table ITABLE_CONSTRAINTS_REF_COLUMNS

ALTER TABLE "ITABLE_CONSTRAINTS_REF_COLUMNS" ADD CONSTRAINT "Key5" PRIMARY KEY ("CONSTRAINT_NAME","OWNER","TABLE_NAME","COLUMN_NAME")
/

-- Create relationships section ------------------------------------------------- 

ALTER TABLE "DIMGR"."COLUMNS" ADD CONSTRAINT "SYS_C0040457" FOREIGN KEY ("OWNER", "TABLE_NAME") REFERENCES "DIMGR"."TABLES" ("OWNER", "TABLE_NAME")
/

ALTER TABLE "DIMGR"."INTER_TABLE_CONS_REF_TABLES" ADD CONSTRAINT "ITCON_REF_TABLES" FOREIGN KEY ("OWNER", "TABLE_NAME", "CONSTRAINT_NAME") REFERENCES "DIMGR"."INTER_TABLE_CONSTRAINTS" ("OWNER", "TABLE_NAME", "CONSTRAINT_NAME")
/

ALTER TABLE "DIMGR"."INTER_TABLE_CONS_REF_TABLES" ADD CONSTRAINT "TBL_ISREFBY_ITCON_REFT" FOREIGN KEY ("REF_OWNER", "REF_TABLE_NAME") REFERENCES "DIMGR"."TABLES" ("OWNER", "TABLE_NAME")
/

ALTER TABLE "DIMGR"."INTER_TABLE_CONSTRAINTS" ADD CONSTRAINT "IT_CON_HAS_TYPE" FOREIGN KEY ("TYPE") REFERENCES "DIMGR"."CONSTRAINT_TYPES" ("TYPE") ON DELETE SET NULL
/

ALTER TABLE "DIMGR"."TABLE_CONSTRAINTS" ADD CONSTRAINT "SYS_C0040461" FOREIGN KEY ("OWNER", "TABLE_NAME") REFERENCES "DIMGR"."TABLES" ("OWNER", "TABLE_NAME")
/

ALTER TABLE "DIMGR"."TABLE_CONSTRAINTS" ADD CONSTRAINT "T_CON_HAS_TYPE" FOREIGN KEY ("TYPE") REFERENCES "DIMGR"."CONSTRAINT_TYPES" ("TYPE") ON DELETE SET NULL
/

ALTER TABLE "DIMGR"."TUPLE_CONSTRAINTS" ADD CONSTRAINT "SYS_C0040463" FOREIGN KEY ("OWNER", "TABLE_NAME") REFERENCES "DIMGR"."TUPLES" ("OWNER", "TABLE_NAME")
/

ALTER TABLE "DIMGR"."TUPLE_CONSTRAINTS_REF_COLUMNS" ADD CONSTRAINT "SYS_C0040464" FOREIGN KEY ("OWNER", "TABLE_NAME", "CONSTRAINT_NAME") REFERENCES "DIMGR"."TUPLE_CONSTRAINTS" ("OWNER", "TABLE_NAME", "CONSTRAINT_NAME")
/

ALTER TABLE "DIMGR"."TUPLE_CONSTRAINTS_REF_COLUMNS" ADD CONSTRAINT "SYS_C0040465" FOREIGN KEY ("OWNER", "TABLE_NAME", "COLUMN_NAME") REFERENCES "DIMGR"."COLUMNS" ("OWNER", "TABLE_NAME", "COLUMN_NAME")
/

ALTER TABLE "DIMGR"."TUPLES" ADD CONSTRAINT "SYS_C0040466" FOREIGN KEY ("OWNER", "TABLE_NAME") REFERENCES "DIMGR"."TABLES" ("OWNER", "TABLE_NAME")
/

ALTER TABLE "TABLE_CONSTRAINTS_REF_COLUMNS" ADD CONSTRAINT "T_CON_REF_COLS" FOREIGN KEY ("OWNER", "TABLE_NAME", "CONSTRAINT_NAME") REFERENCES "DIMGR"."TABLE_CONSTRAINTS" ("OWNER", "TABLE_NAME", "CONSTRAINT_NAME")
/

ALTER TABLE "TABLE_CONSTRAINTS_REF_COLUMNS" ADD CONSTRAINT "COL_IS_REFBY_TCON" FOREIGN KEY ("OWNER", "TABLE_NAME", "COLUMN_NAME") REFERENCES "DIMGR"."COLUMNS" ("OWNER", "TABLE_NAME", "COLUMN_NAME")
/

ALTER TABLE "ITABLE_CONSTRAINTS_REF_COLUMNS" ADD CONSTRAINT "IT_CON_REF_COLS" FOREIGN KEY ("OWNER", "TABLE_NAME", "CONSTRAINT_NAME") REFERENCES "DIMGR"."INTER_TABLE_CONSTRAINTS" ("OWNER", "TABLE_NAME", "CONSTRAINT_NAME")
/

ALTER TABLE "ITABLE_CONSTRAINTS_REF_COLUMNS" ADD CONSTRAINT "COL_IS_REFBY_ITCON" FOREIGN KEY ("OWNER", "TABLE_NAME", "COLUMN_NAME") REFERENCES "DIMGR"."COLUMNS" ("OWNER", "TABLE_NAME", "COLUMN_NAME")
/

ALTER TABLE "DIMGR"."INTER_TABLE_CONSTRAINTS" ADD CONSTRAINT "TBL_ISREFBY_ITCON" FOREIGN KEY ("OWNER", "TABLE_NAME") REFERENCES "DIMGR"."TABLES" ("OWNER", "TABLE_NAME")
/


-- Grant permissions section -------------------------------------------------


